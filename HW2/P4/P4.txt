Acknowledgments: Avery Faller explained a lot of the logic of events and threads to me for this problem.  
